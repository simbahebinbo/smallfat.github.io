<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="356px" height="1121px" viewBox="-0.5 -0.5 356 1121" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36&quot; version=&quot;8.5.3&quot; editor=&quot;www.draw.io&quot; type=&quot;device&quot;&gt;&lt;diagram&gt;7VrbbuM2EP2WPvBxC91NPkq2vH1IFwsERbtPC23MtVTYplemY7tf3xmSuiuJNnFkFSgQIOSIF3l4zpBnKOLOt+ePebJPfxcrviGOtToTd0Ecx/YcC/6h5WIslHnass6zlbFVhvvsH26MpuP6mK34odFQCrGR2b5pfBC7HX+QDVuS5+LUbPZdbJqz7pM17xjuH5JN1/pntpKptlLfquy/8WydFjPblnmyTYrGxnBIk5U41UxuTNx5LoTUpe15zjfovcIvut/yiafli+V8J4d0cB3d4zHZHM2PMy8mL8Wv5Sv48aYqcpmKtdglm7iyRrk47lYch7SgVrW5E2IPRhuMf3MpL2Ylk6MUYErldmOe6jlxoid/hzEdxDF/MK1cs/RJvuamlROUTgT4cbHlMr9Am5xvEpk9NodPDAzWZbvKU1AwznrCcV2/xT6hS8ICLEQxYTMSB4QyQi0ssDmU95zn0GsHlCDxjLCQUE/yfKv6zkkUkphhx8gjsUeiJQltNYhNwiWJKVZDSuIliebYHnqFC8Ko6g5lH8f/epAiBwTC/0QeD53lrBYLPX9KM8nv94ny6Qn42rcwPevwyHPJzzVT1+fmqVOA37CdmuqpYo7jGVtaY01gvX2VvAmh+wUw+10wF+GuxYsR0O33oJshDOlCYS0mNFAIpYSGCEyAamQhpEOmUBwghFlcg2qAEAZ+6F5huAaoIaJj1VEZoxCwuJ0cYEdFbDBtxDbg6V8bnqbrZ5HBtOV6uE5zPfy2nzWNTK+Wq8vXGOT9WQ/uIXRHKiAHGNsRrBShHKnwHgElHMQ90CAKVKy2kCdIEqq2gDJod9pMDefUGxHn9Baw5udM/lUrf8GhfvVNbXE2I6vKpajs4JeVnbBS64XVqpuqFf0GBf0iwjdo5b4LrcI8Ty61Bnuky+Fp1nm0iQ6vfZJ8ob1tzawWIPQrvJabbNqR8aVlde1bbebF29Q8p/dZ6xdVsz79cXdH3GU3IKVi+w1OkLcIRu7QTZdeIRjZdsdD08WWM0bIGOy5rn402NLQwsoH4gTJFiGzhveNdvwsJ7f3sTH3PrsrHnHLmZxTbGtUr/yHxJrdp9ZmNyPhMLn2umNrLdfQzm6U+k8XrFLb5fzHkR9kmeJQhQi1HspAmGmmEiEwErPw7apJQEDO8a8zZF9mQydNqG8GCiOlKbuZFPMWek49lU6ZLEjkpjxZfVWjgzvNUzY5KgbWQCaWqcY3AWriKrRBxVmXirdjYp+ABPh5hC0Vy4BcMOsPxJozx10S2cQUBzW/bMVcJKMCMwA4Iow1QDo1bM5G3SXotKHZ2BGca+NwWIKEtWPA9RIkdjc0jqjbC3H+U7q9rFxTt/cdwq+erX2Vbre9Fhhmz+v2dvuWzn+zbHe66nNShK0vax+JbyatnK4ojXfK7SFuHE6wQTX1LYeS0lVmB6E6ZeljptKxPn+c301uw/jgjLhh9N3UTQl/jdtLOs6G4XltofduG0bfVdKU3N+gf9BdkqvfcQzGbc8ZXN8ng/rSOi2ynrk7png1XAgrFQbQCiLML8RVVNNn7Yvqnqu8qUURe8xruZ7s85f/T0KkSmuPcO796ZNQ0ASM775wEgqePTm9+STkdk9CnyYbC3vX9WbB0O2ehUwMDIuL2VCluqIFYa56xFTya0jOq0x1lVEzwG9q8IsbnVcKGh/aQHzExmrG0EOVPrGrE4+939UJVKuP0zQHqm/83Phf&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 187 160 L 187 193.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 198.88 L 183.5 191.88 L 187 193.63 L 190.5 191.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="100" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(68.5,116.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="236" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 236px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">取得所有peer node的term区间信息表，存入peer_storage_status</div></div></foreignObject></switch></g><path d="M 187 360 L 187 393.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 398.88 L 183.5 391.88 L 187 393.63 L 190.5 391.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="300" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(99.5,323.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="174" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 176px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">遍历上述空洞，每个gap记为item</div></div></foreignObject></switch></g><path d="M 187 580 L 187 613.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 618.88 L 183.5 611.88 L 187 613.63 L 190.5 611.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="860" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(126.5,883.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="120" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 121px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">更新请求状态列表状态</div></div></foreignObject></switch></g><path d="M 307 440 L 347 440 L 347 1090 L 313.37 1090" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 308.12 1090 L 315.12 1086.5 L 313.37 1090 L 315.12 1093.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 480 L 187 500 L 187 490 L 187 503.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 508.88 L 183.5 501.88 L 187 503.63 L 190.5 501.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 400 L 307 440 L 187 480 L 67 440 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(147.5,433.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="78" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">item != NULL?</div></div></foreignObject></switch></g><path d="M 187 1020 L 187 1053.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 1058.88 L 183.5 1051.88 L 187 1053.63 L 190.5 1051.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="960" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(140.5,983.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="92" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 94px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">item = item-&gt;next</div></div></foreignObject></switch></g><rect x="67" y="1060" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(177.5,1083.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 20px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">exit</div></div></foreignObject></switch></g><path d="M 187 720 L 187 753.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 758.88 L 183.5 751.88 L 187 753.63 L 190.5 751.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="620" width="240" height="100" rx="15" ry="15" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(68.5,649.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="236" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 236px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">遍历请求状态列表，取得上一个request的目标peer后，第一个peer_storage_status包含gap区间的peer（即head_peer_id）</div></div></foreignObject></switch></g><path d="M 187 820 L 187 853.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 858.88 L 183.5 851.88 L 187 853.63 L 190.5 851.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="760" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(83.5,783.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="206" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 206px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">生成req_id, 并发送gap给head_peer_id</div></div></foreignObject></switch></g><path d="M 187 920 L 187 953.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 958.88 L 183.5 951.88 L 187 953.63 L 190.5 951.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 67 990 L 7 990 L 7 440 L 60.63 440" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 65.88 440 L 58.88 443.5 L 60.63 440 L 58.88 436.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 60 L 187 93.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 98.88 L 183.5 91.88 L 187 93.63 L 190.5 91.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="0" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(156.5,16.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="60" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 62px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Entry: <br />参数 PGCL</div></div></foreignObject></switch></g><path d="M 187 260 L 187 293.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 298.88 L 183.5 291.88 L 187 293.63 L 190.5 291.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="67" y="200" width="240" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(80.5,223.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="212" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 214px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">找到term区间中，PGCL以下的所有空洞</div></div></foreignObject></switch></g><path d="M 67 550 L 27 550 L 27 990 L 60.63 990" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 65.88 990 L 58.88 993.5 L 60.63 990 L 58.88 986.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(23.5,764.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="7" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Y</div></div></foreignObject></switch></g><path d="M 187 590 L 187 610 L 187 600 L 187 613.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 187 618.88 L 183.5 611.88 L 187 613.63 L 190.5 611.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(182.5,599.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="8" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">N</div></div></foreignObject></switch></g><path d="M 187 510 L 307 550 L 187 590 L 67 550 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(83.5,543.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="206" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 208px; white-space: nowrap; overflow-wrap: normal; text-align: center;" class="xsj_foreignObject xsj_drawio_foreignObject"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">判断当前请求状态表中是否存在此gap?</div></div></foreignObject></switch></g></g></svg>